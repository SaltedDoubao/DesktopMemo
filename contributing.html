<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>贡献指南 - DesktopMemo Docs</title>

    <script src="theme-preload.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="layout">
        <nav class="sidebar">
            <div class="sidebar-logo">DesktopMemo</div>

            <h3>概览</h3>
            <ul>
                <li><a href="index.html">首页</a></li>
                <li><a href="contributing.html" class="active">贡献指南</a></li>
                <li><a href="mysql_integration.html">MySQL 集成规范</a></li>
            </ul>

            <h3>项目架构</h3>
            <ul>
                <li><a href="project_structure/index.html">架构首页</a></li>
                <li><a href="project_structure/architecture.html">01 架构图</a></li>
                <li><a href="project_structure/modules.html">02 模块划分</a></li>
                <li><a href="project_structure/tech_stack.html">03 技术栈和依赖</a></li>
                <li><a href="project_structure/data_flow.html">04 数据流和通信</a></li>
            </ul>

            <h3>API 文档</h3>
            <ul>
                <li><a href="api/index.html">API 概览</a></li>
            </ul>
        </nav>

        <main class="content">
            <div class="content-inner">
                <h1>DesktopMemo 贡献指南</h1>
                <p>欢迎参与 DesktopMemo 项目的开发!本指南将帮助您了解如何为项目做出贡献。</p>

                <h2>📋 目录</h2>
                <ul>
                    <li>贡献方式</li>
                    <li>开发环境设置</li>
                    <li>项目结构</li>
                    <li>开发流程</li>
                    <li>代码规范</li>
                    <li>提交规范</li>
                    <li>Pull Request 流程</li>
                    <li>测试要求</li>
                    <li>文档维护</li>
                    <li>常见问题</li>
                </ul>

                <hr>

                <h2>🤝 贡献方式</h2>
                <p>您可以通过以下方式为项目做出贡献：</p>
                <ul>
                    <li>🐛 <strong>报告 Bug</strong>：在 Issues 中提交详细的问题描述</li>
                    <li>💡 <strong>功能建议</strong>：提出新功能或改进建议</li>
                    <li>📝 <strong>完善文档</strong>：改进文档、添加示例、修复错别字</li>
                    <li>🔧 <strong>提交代码</strong>：修复 Bug、实现新功能、优化性能</li>
                    <li>🌐 <strong>本地化翻译</strong>：添加或改进多语言支持</li>
                    <li>⭐ <strong>推广项目</strong>：给项目加星标、分享给其他开发者</li>
                </ul>

                <hr>

                <h2>🛠️ 开发环境设置</h2>

                <h3>系统要求</h3>
                <ul>
                    <li><strong>操作系统</strong>：Windows 10 版本 1903 及以上</li>
                    <li><strong>架构</strong>：x86_64</li>
                    <li><strong>.NET SDK</strong>：<a href="https://dotnet.microsoft.com/zh-cn/download/dotnet/9.0">.NET
                            9.0</a></li>
                    <li><strong>IDE</strong>：Visual Studio 2022 / VS Code / Rider（任选其一）</li>
                </ul>

                <h3>获取源码</h3>
                <pre><code class="language-bash"># 1. Fork 本仓库到你的账号

# 2. 克隆你的 Fork
git clone https://github.com/yourname/DesktopMemo.git
cd DesktopMemo

# 3. 添加上游仓库
git remote add upstream https://github.com/SaltedDoubao/DesktopMemo.git
</code></pre>

                <h3>构建项目</h3>
                <pre><code class="language-powershell"># 还原依赖（首次运行或更改输出目录后必须执行）
dotnet restore DesktopMemo.sln

# 调试构建
dotnet build DesktopMemo.sln --configuration Debug

# 运行应用
dotnet run --project src/DesktopMemo.App/DesktopMemo.App.csproj --configuration Debug
</code></pre>
                <blockquote>
                    <p>⚠️ <strong>重要提示</strong>：如果未更改版本号，使用 <code>dotnet build</code> 构建项目前<strong>必须</strong>清空
                        <code>artifacts/vX.X.X(对应版本号)</code> 目录，避免残留文件导致编译错误。
                    </p>
                </blockquote>

                <h3>数据目录</h3>
                <p>首次运行会在可执行文件目录生成 <code>/.memodata</code>：</p>
                <pre><code>.memodata/
├── content/              # 备忘录Markdown文件
├── .logs/                # 日志文件目录
├── settings.json         # 窗口与全局设置
├── memos.db              # 备忘录数据库（v2.3.0+）
└── todos.db              # 待办事项数据库（v2.3.0+）
</code></pre>

                <hr>

                <h2>📂 项目结构</h2>
                <p>DesktopMemo 采用三层架构设计，详细的架构说明请参阅 <a href="project_structure/index.html">项目架构文档</a>。</p>

                <hr>

                <h2>🔄 开发流程</h2>

                <h3>1. 同步上游代码</h3>
                <p>开始开发前，确保你的 Fork 是最新的：</p>
                <pre><code class="language-bash">git fetch upstream
git checkout dev
git merge upstream/dev
</code></pre>

                <h3>2. 创建功能分支</h3>
                <pre><code class="language-bash"># 从 dev 分支创建新分支
git checkout -b feature/your-feature-name

# 或者修复 Bug
git checkout -b fix/bug-description
</code></pre>

                <h3>3. 开发和测试</h3>
                <ul>
                    <li>遵循<a href="#code-style">代码规范</a></li>
                    <li>添加必要的注释和文档</li>
                    <li>确保代码能够正常编译运行</li>
                </ul>

                <h3>4. 提交更改</h3>
                <pre><code class="language-bash">git add .
git commit -m "feat: 添加新功能的简短描述"
</code></pre>

                <h3>5. 推送分支</h3>
                <pre><code class="language-bash">git push origin feature/your-feature-name
</code></pre>

                <h3>6. 创建 Pull Request</h3>
                <p>参考 <a href="#pr-process">Pull Request 流程</a>。</p>

                <hr>

                <h2 id="code-style">📝 代码规范</h2>

                <h3>基本原则</h3>
                <ul>
                    <li><strong>遵循 C# 编码规范</strong>：使用 PascalCase 命名类、方法、属性，camelCase 命名局部变量</li>
                    <li><strong>使用依赖注入</strong>：通过构造函数注入依赖，避免硬编码</li>
                    <li><strong>保持单一职责</strong>：每个类、方法应有明确的单一职责</li>
                    <li><strong>优先使用接口</strong>：面向接口编程，便于测试和扩展</li>
                </ul>

                <h3>异步编程规范 ⚠️</h3>
                <blockquote>
                    <p><strong>关键规范</strong>：错误的异步编程可能导致应用崩溃！</p>
                </blockquote>

                <h4>❌ 错误做法 - 可能导致死锁</h4>
                <pre><code class="language-csharp">private async void Button_Click(object sender, RoutedEventArgs e)
{
    await SomeAsyncOperation(); // 危险！可能导致死锁
}
</code></pre>

                <h4>✅ 正确做法 - Fire-and-Forget 模式</h4>
                <pre><code class="language-csharp">private void Button_Click(object sender, RoutedEventArgs e)
{
    // 使用 fire-and-forget 模式
    _ = Task.Run(async () => await HandleButtonClickAsync());
}

private async Task HandleButtonClickAsync()
{
    // 异步逻辑放在这里
}
</code></pre>

                <hr>

                <h2>📋 提交规范</h2>

                <h3>Commit Message 格式</h3>
                <pre><code>&lt;类型&gt;(&lt;范围&gt;): &lt;简短描述&gt;

&lt;详细描述&gt;（可选）

&lt;关联 Issue&gt;（可选）
</code></pre>

                <h3>类型说明</h3>
                <ul>
                    <li><code>feat</code>: 新功能</li>
                    <li><code>fix</code>: Bug 修复</li>
                    <li><code>docs</code>: 文档更新</li>
                    <li><code>style</code>: 代码格式（不影响功能）</li>
                    <li><code>refactor</code>: 重构（既不是新增功能也不是修复 Bug）</li>
                    <li><code>perf</code>: 性能优化</li>
                </ul>

                <hr>

                <h2 id="pr-process">🔀 Pull Request 流程</h2>
                <ol>
                    <li>在 GitHub 上创建 Pull Request，目标分支通常是 <code>dev</code>。</li>
                    <li>填写 PR 描述模板。</li>
                    <li>等待 Code Review。</li>
                    <li>修改代码直到合并。</li>
                </ol>

                <hr>

                <h2>✅ 测试要求</h2>
                <h3>基本验证</h3>
                <pre><code class="language-powershell"># 2. 构建验证
dotnet clean DesktopMemo.sln
dotnet restore DesktopMemo.sln
dotnet build DesktopMemo.sln --configuration Debug

# 3. 运行应用
dotnet run --project src/DesktopMemo.App/DesktopMemo.App.csproj --configuration Debug
</code></pre>

                <hr>

                <h2>📚 文档维护</h2>
                <p>需要更新文档的情况：</p>
                <table>
                    <thead>
                        <tr>
                            <th>变更类型</th>
                            <th>需要更新的文档</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>新增模块/功能</strong></td>
                            <td><code>docs/ProjectStructure/01_架构图.md</code><br><code>docs/ProjectStructure/02_模块划分.md</code><br><code>README.md</code>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>升级依赖或更换技术</strong></td>
                            <td><code>docs/ProjectStructure/03_技术栈和依赖.md</code></td>
                        </tr>
                        <tr>
                            <td><strong>修改业务流程</strong></td>
                            <td><code>docs/ProjectStructure/04_数据流和通信.md</code></td>
                        </tr>
                    </tbody>
                </table>

                <hr>

                <h2>❓ 常见问题</h2>
                <p><strong>Q: <code>NETSDK1005</code>：找不到 <code>project.assets.json</code></strong><br>
                    A: 先运行 <code>dotnet restore DesktopMemo.sln</code>，必要时删除 <code>artifacts/</code> 目录后重新构建。</p>

                <p><strong>Q: 数据绑定未刷新</strong><br>
                    A: 检查是否调用 <code>OnPropertyChanged</code>，确认 ViewModel 继承自 <code>ObservableObject</code>。</p>

                <hr>

                <h2>🌟 行为准则</h2>
                <ul>
                    <li><strong>尊重他人</strong>：保持友好和专业的沟通方式</li>
                    <li><strong>建设性反馈</strong>：提供有帮助的建议和批评</li>
                    <li><strong>包容性</strong>：欢迎不同背景和技能水平的贡献者</li>
                </ul>

                <hr>

                <p><strong>最后更新</strong>：2025-11-17</p>
            </div>
        </main>
    </div>

    <script src="main.js"></script>
</body>

</html>