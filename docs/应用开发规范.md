# DesktopMemo åº”ç”¨å¼€å‘è§„èŒƒ

æœ¬æ–‡æ¡£é¢å‘å‚ä¸ DesktopMemo å¼€å‘çš„æˆå‘˜ï¼Œå¸®åŠ©ä½ å¿«é€Ÿäº†è§£é¡¹ç›®ç»“æ„ã€å¼€å‘ç¯å¢ƒã€æ„å»º/è¿è¡Œæµç¨‹åŠå¸¸è§è°ƒè¯•è·¯å¾„ã€‚

## 1. é¡¹ç›®æ¦‚è§ˆ

- **è§£å†³æ–¹æ¡ˆ**ï¼š`DesktopMemo.sln`
- **æ ¸å¿ƒç»„ä»¶**
  - `DesktopMemo.App`ï¼šWPF å‰ç«¯ï¼ˆUIã€å‘½ä»¤ã€è§†å›¾æ¨¡å‹ï¼‰ã€‚
  - `DesktopMemo.Core`ï¼šé¢†åŸŸæ¨¡å‹ä¸å¥‘çº¦æ¥å£ï¼ˆçº¯ .NET åº“ï¼‰ã€‚
  - `DesktopMemo.Infrastructure`ï¼šæ–‡ä»¶å­˜å‚¨ã€è®¾ç½®æœåŠ¡ç­‰å®ç°ã€‚
- **æ•°æ®å­˜å‚¨**ï¼šé»˜è®¤å†™å…¥å¯æ‰§è¡Œæ–‡ä»¶ç›®å½•ä¸‹çš„ `/.memodata`
  - å¤‡å¿˜å½•ï¼šMarkdown æ–‡ä»¶ï¼ˆYAML Front Matterï¼‰ + `index.json` ç´¢å¼•
  - å¾…åŠäº‹é¡¹ï¼š`todos.json` æ–‡ä»¶
  - åº”ç”¨è®¾ç½®ï¼š`settings.json` æ–‡ä»¶

## 2. å¼€å‘ç¯å¢ƒè¦æ±‚

- Windows 10 åŠä»¥ä¸Šï¼ˆéœ€å¯ç”¨ .NET æ¡Œé¢è¿è¡Œæ—¶æ”¯æŒï¼‰ã€‚
- [.NET SDK 9.0](https://dotnet.microsoft.com/zh-cn/download/dotnet/9.0)ã€‚
- æ¨è IDEï¼šåªè¦ä½ å–œæ¬¢ï¼Œçˆ±ç”¨ä»€ä¹ˆç”¨ä»€ä¹ˆğŸ˜‚ã€‚

## 3. é¡¹ç›®ç»“æ„

```
DesktopMemo_rebuild/
â”œâ”€â”€ DesktopMemo.sln
â”œâ”€â”€ build_exe.bat                   # æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶è„šæœ¬
â”œâ”€â”€ docs/                           # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ DesktopMemo.App/            # WPF å‰ç«¯
â”‚   â”‚   â”œâ”€â”€ App.xaml(.cs)           # å¯åŠ¨ä¸ DI æ³¨å†Œ
â”‚   â”‚   â”œâ”€â”€ MainWindow.xaml(.cs)    # ä¸»çª—å£
â”‚   â”‚   â”œâ”€â”€ ViewModels/             # MVVM è§†å›¾æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ MainViewModel.cs    # ä¸»è§†å›¾æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ MemoListViewModel.cs
â”‚   â”‚   â”‚   â””â”€â”€ TodoListViewModel.cs # å¾…åŠäº‹é¡¹è§†å›¾æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Converters/             # å€¼è½¬æ¢å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ EnumToBooleanConverter.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ InverseBooleanToVisibilityConverter.cs
â”‚   â”‚   â”‚   â””â”€â”€ CountToVisibilityConverter.cs # æ•°å­—åˆ°å¯è§æ€§è½¬æ¢å™¨
â”‚   â”‚   â””â”€â”€ Resources/              # æ ·å¼ä¸èµ„æº
â”‚   â”œâ”€â”€ DesktopMemo.Core/           # é¢†åŸŸæ¨¡å‹ä¸å¥‘çº¦
â”‚   â”‚   â”œâ”€â”€ Contracts/
â”‚   â”‚   â”‚   â”œâ”€â”€ IMemoRepository.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ ITodoRepository.cs  # å¾…åŠäº‹é¡¹ä»“å‚¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ ISettingsService.cs
â”‚   â”‚   â”‚   â””â”€â”€ IWindowService.cs ç­‰
â”‚   â”‚   â””â”€â”€ Models/
â”‚   â”‚       â”œâ”€â”€ Memo.cs
â”‚   â”‚       â”œâ”€â”€ TodoItem.cs         # å¾…åŠäº‹é¡¹æ¨¡å‹
â”‚   â”‚       â””â”€â”€ WindowSettings.cs
â”‚   â””â”€â”€ DesktopMemo.Infrastructure/ # å®ç°å±‚ï¼ˆæ–‡ä»¶å­˜å‚¨ã€ç³»ç»ŸæœåŠ¡ï¼‰
â”‚       â”œâ”€â”€ Repositories/
â”‚       â”‚   â”œâ”€â”€ FileMemoRepository.cs
â”‚       â”‚   â””â”€â”€ JsonTodoRepository.cs # JSON å¾…åŠäº‹é¡¹å­˜å‚¨
â”‚       â””â”€â”€ Services/
â”‚           â”œâ”€â”€ JsonSettingsService.cs
â”‚           â”œâ”€â”€ MemoSearchService.cs
â”‚           â”œâ”€â”€ WindowService.cs
â”‚           â””â”€â”€ TrayService.cs ç­‰
â”œâ”€â”€ artifacts/                      # æ„å»ºè¾“å‡ºç›®å½•
â””â”€â”€ publish/                        # å‘å¸ƒäº§ç‰©
```

### å…³é”®ç›®å½•

- `DesktopMemo.App/ViewModels/MainViewModel.cs`ï¼šåº”ç”¨æ ¸å¿ƒé€»è¾‘ï¼Œå¤„ç†å¤‡å¿˜å½•åˆ—è¡¨ã€ç¼–è¾‘çŠ¶æ€ã€é¡µé¢åˆ‡æ¢ä¸è®¾ç½®é¢æ¿ã€‚
- `DesktopMemo.App/ViewModels/TodoListViewModel.cs`ï¼šå¾…åŠäº‹é¡¹è§†å›¾æ¨¡å‹ï¼Œå¤„ç†å¾…åŠäº‹é¡¹çš„å¢åˆ æ”¹æŸ¥å’ŒçŠ¶æ€åˆ‡æ¢ã€‚
- `DesktopMemo.Infrastructure/Repositories/FileMemoRepository.cs`ï¼šæ–‡ä»¶å­˜å‚¨å®ç°ï¼Œç»´æŠ¤ `content` ç›®å½•å’Œ `index.json`ã€‚
- `DesktopMemo.Infrastructure/Repositories/JsonTodoRepository.cs`ï¼šJSON å¾…åŠäº‹é¡¹å­˜å‚¨å®ç°ï¼Œç»´æŠ¤ `todos.json`ã€‚
- `DesktopMemo.App/Converters/CountToVisibilityConverter.cs`ï¼šæ•°å­—åˆ°å¯è§æ€§è½¬æ¢å™¨ï¼Œç”¨äº UI æ˜¾ç¤ºæ§åˆ¶ã€‚
- `DesktopMemo.App/Resources/Styles.xaml`ï¼šå…¨å±€æ ·å¼ä¸ä¸»é¢˜ã€‚

## 4. æ„å»ºä¸è¾“å‡º

é¡¹ç›®ä½¿ç”¨ `Directory.Build.props` ç»Ÿä¸€è¾“å‡ºè·¯å¾„ï¼š

- äºŒè¿›åˆ¶äº§ç‰©ï¼š`artifacts/v<ç‰ˆæœ¬>/bin/<é¡¹ç›®å>/<é…ç½®>/<ç›®æ ‡æ¡†æ¶>/`
- ä¸­é—´æ–‡ä»¶ï¼š`artifacts/v<ç‰ˆæœ¬>/obj/<é¡¹ç›®å>/<é…ç½®>/<ç›®æ ‡æ¡†æ¶>/`

`<ç‰ˆæœ¬>` é»˜è®¤å–è‡ª `DesktopMemo.App.csproj` çš„ `Version` å±æ€§ï¼ˆå½“å‰ä¸º `2.0.0`ï¼‰ã€‚å¦‚éœ€è‡ªå®šä¹‰ï¼Œæ„å»ºå‰å¯è®¾ç½®ç¯å¢ƒå˜é‡ `ArtifactsVersion`ï¼ˆç¤ºä¾‹ï¼šPowerShell ä¸­æ‰§è¡Œ `$env:ArtifactsVersion = '2.1.0'`ï¼‰ã€‚

å¸¸ç”¨å‘½ä»¤ï¼š

```powershell
# è¿˜åŸä¾èµ–ï¼ˆé¦–æ¬¡æˆ–æ›´æ¢è¾“å‡ºç›®å½•ååŠ¡å¿…æ‰§è¡Œï¼‰
dotnet restore DesktopMemo.sln

# è°ƒè¯•æ„å»º
dotnet build DesktopMemo.sln --configuration Debug

# è¿è¡Œåº”ç”¨ï¼ˆå¤ç”¨å·²æœ‰æ„å»ºäº§ç‰©ï¼‰
dotnet run --project src/DesktopMemo.App/DesktopMemo.App.csproj --configuration Debug
```

> **å»ºè®®**ï¼šå¦‚æœç¼–è¯‘å‰ä¸è°ƒæ•´ `BaseOutputPath` / `BaseIntermediateOutputPath` æˆ–ç‰ˆæœ¬å·ï¼Œå…ˆæ¸…ç†æ—§ç›®å½•ï¼ˆ`artifacts/vX.X.X(å¯¹åº”ç‰ˆæœ¬å·)`ï¼‰å†æ‰§è¡Œ `restore` + `build`ï¼Œé¿å…æ®‹ç•™æ–‡ä»¶å¯¼è‡´é‡å¤ç¼–è¯‘é”™è¯¯ã€‚

## 5. ç‰ˆæœ¬å·ç®¡ç†

æ‰‹åŠ¨æå‡ç‰ˆæœ¬æ—¶ï¼Œè¯·ç¡®è®¤ä»¥ä¸‹ä½ç½®åŒæ­¥æ›´æ–°ï¼š

- `DesktopMemo.App/DesktopMemo.App.csproj` ä¸­çš„ `<Version>`ã€`<AssemblyVersion>`ã€`<FileVersion>`ã€‚
- `Directory.Build.props` é‡Œçš„ `ArtifactsVersion` é»˜è®¤å€¼ï¼ˆå†³å®š `artifacts/vX.Y.Z/...` è·¯å¾„ï¼‰ã€‚
- `MainViewModel.InitializeAppInfo()` ä¸­çš„å›é€€å­—ç¬¦ä¸²ï¼ˆç”¨äº UI å±•ç¤ºï¼‰ã€‚
- æ–‡æ¡£å’Œå‘½ä»¤ç¤ºä¾‹ï¼šæœç´¢ä»“åº“ä¸­æ—§ç‰ˆæœ¬å·ï¼ˆå¦‚ `2.0.0`ï¼‰ï¼Œæ›´æ–° `README.md`ã€`docs/development-guide.md` ç­‰è¯´æ˜ã€‚

å®Œæˆä¿®æ”¹åï¼Œå»ºè®®æ‰§è¡Œï¼š

```powershell
dotnet clean DesktopMemo.sln
dotnet restore DesktopMemo.sln
dotnet build DesktopMemo.sln -c Debug
```

ç¡®ä¿æ„å»ºäº§ç‰©å†™å…¥æ–°çš„ç‰ˆæœ¬ç›®å½•ï¼Œåº”ç”¨ UI äº¦èƒ½æ­£ç¡®æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚

## 6. è°ƒè¯•æŠ€å·§

- **Visual Studio**
  - ä»¥ `DesktopMemo.App` ä½œä¸ºå¯åŠ¨é¡¹ç›®ï¼Œä½¿ç”¨ WPF è¯Šæ–­å·¥å…·è§‚å¯Ÿç»‘å®šã€å¸ƒå±€ã€‚
  - åœ¨ `MainViewModel` ä¸­è®¾ç½®æ–­ç‚¹ï¼Œè°ƒè¯•å‘½ä»¤æ‰§è¡Œä¸çŠ¶æ€åˆ‡æ¢ã€‚
- **VS Code / Rider**
  - ä½¿ç”¨ `dotnet run` æˆ– IDE é›†æˆçš„è°ƒè¯•é…ç½®ï¼Œç¡®ä¿ `--no-build` ä»…åœ¨å·²æœ‰æ„å»ºçš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚
- **æ•°æ®é—®é¢˜æ’æŸ¥**
  - å¤‡å¿˜å½•æ•°æ®ï¼šæ£€æŸ¥ `/.memodata/content` ä¸­çš„ Markdown æ–‡ä»¶åŠ `index.json`
  - å¾…åŠäº‹é¡¹æ•°æ®ï¼šæ£€æŸ¥ `/.memodata/todos.json` æ–‡ä»¶
  - åº”ç”¨è®¾ç½®ï¼šæ£€æŸ¥ `/.memodata/settings.json` æ–‡ä»¶
  - è‹¥éœ€è¦é‡ç½®æ•°æ®ï¼Œå¯åˆ é™¤ `.memodata` ç›®å½•ï¼Œåº”ç”¨ä¼šåœ¨ä¸‹æ¬¡å¯åŠ¨æ—¶é‡æ–°åˆ›å»ºã€‚

## 7. å‘å¸ƒä¸éƒ¨ç½²ï¼ˆè‰æ¡ˆï¼‰

1. æ›´æ–° `DesktopMemo.App.csproj` ä¸­çš„ `Version` / `FileVersion`ã€‚
2. æ‰§è¡Œ `.\build_exe.bat`
3. å°†å‘å¸ƒç›®å½•æ‰“åŒ…å‘å¸ƒï¼›è‹¥éœ€è¦å®‰è£…åŒ…ï¼Œå¯ç»“åˆ MSIX/WiX ç­‰å·¥å…·å¦è¡Œé…ç½®ã€‚

## 8. å¼‚æ­¥ç¼–ç¨‹æœ€ä½³å®è·µ

âš ï¸ **é‡è¦**: æœ¬èŠ‚åŒ…å«é˜²æ­¢åº”ç”¨å´©æºƒçš„å…³é”®è§„èŒƒï¼ŒåŠ¡å¿…éµå®ˆã€‚

### 8.1 async void ä½¿ç”¨è§„èŒƒ

**âŒ é”™è¯¯åšæ³• - å¯èƒ½å¯¼è‡´æ­»é”å´©æºƒ**:
```csharp
private async void Button_Click(object sender, RoutedEventArgs e)
{
    await SomeAsyncOperation(); // å±é™©ï¼å¯èƒ½å¯¼è‡´æ­»é”
}
```

**âœ… æ­£ç¡®åšæ³•**:
```csharp
private void Button_Click(object sender, RoutedEventArgs e)
{
    // æ–¹æ¡ˆ1: ä½¿ç”¨ fire-and-forget æ¨¡å¼
    _ = Task.Run(async () => await HandleButtonClickAsync());
}

private async Task HandleButtonClickAsync()
{
    // å¼‚æ­¥é€»è¾‘æ”¾åœ¨è¿™é‡Œ
}
```

### 8.2 UIçº¿ç¨‹ä¸åå°çº¿ç¨‹åˆ‡æ¢

**åŸåˆ™**: UIæ“ä½œå¿…é¡»åœ¨UIçº¿ç¨‹ï¼ŒIOæ“ä½œåº”åœ¨åå°çº¿ç¨‹ã€‚

```csharp
// âœ… æ­£ç¡®çš„çº¿ç¨‹åˆ‡æ¢æ¨¡å¼
await Task.Run(async () =>
{
    // åå°çº¿ç¨‹æ‰§è¡ŒIOæ“ä½œ
    await _settingsService.SaveAsync(settings);

    // åˆ‡æ¢å›UIçº¿ç¨‹æ›´æ–°ç•Œé¢
    await Application.Current.Dispatcher.InvokeAsync(() =>
    {
        ViewModel.Settings = settings;
    });
});
```

### 8.3 å¼‚å¸¸å¤„ç†è§„èŒƒ

```csharp
// âœ… å®Œæ•´çš„å¼‚å¸¸å¤„ç†
try
{
    await SomeAsyncOperation();
}
catch (InvalidOperationException ex)
{
    // ç‰¹å®šå¼‚å¸¸çš„å¤„ç†
    Debug.WriteLine($"æ“ä½œæ— æ•ˆ: {ex.Message}");
}
catch (UnauthorizedAccessException ex)
{
    // æƒé™é—®é¢˜çš„å¤„ç†
    ShowUserFriendlyError("æƒé™ä¸è¶³");
}
catch (Exception ex)
{
    // é€šç”¨å¼‚å¸¸å¤„ç†
    Debug.WriteLine($"æœªçŸ¥é”™è¯¯: {ex}");
    // æä¾›å›é€€æ–¹æ¡ˆ
}
```

### 8.4 è®¾ç½®ä¿å­˜æœ€ä½³å®è·µ

```csharp
// âœ… éé˜»å¡è®¾ç½®ä¿å­˜
if (dialog.DontShowAgain)
{
    // ä¸ç­‰å¾…è®¾ç½®ä¿å­˜ï¼Œé¿å…é˜»å¡ä¸»è¦æ“ä½œ
    _ = Task.Run(async () =>
    {
        try
        {
            var newSettings = settings with { ShowConfirmation = false };
            await _settingsService.SaveAsync(newSettings);

            // UIæ›´æ–°å¿…é¡»åœ¨UIçº¿ç¨‹
            await Application.Current.Dispatcher.InvokeAsync(() =>
            {
                Settings = newSettings;
            });
        }
        catch (Exception ex)
        {
            Debug.WriteLine($"ä¿å­˜è®¾ç½®å¤±è´¥: {ex}");
            // è®¾ç½®ä¿å­˜å¤±è´¥ä¸åº”å½±å“ä¸»è¦åŠŸèƒ½
        }
    });
}
```

### 8.5 è°ƒè¯•å¼‚æ­¥é—®é¢˜

- **ä½¿ç”¨è°ƒè¯•è¾“å‡º**: å…³é”®å¼‚æ­¥æ“ä½œæ·»åŠ  `Debug.WriteLine`
- **æ£€æŸ¥çº¿ç¨‹ID**: ç¡®è®¤æ“ä½œåœ¨æ­£ç¡®çš„çº¿ç¨‹æ‰§è¡Œ
- **å¼‚å¸¸æ—¥å¿—**: è®°å½•å®Œæ•´çš„å¼‚å¸¸å †æ ˆï¼ŒåŒ…æ‹¬å†…éƒ¨å¼‚å¸¸

```csharp
Debug.WriteLine($"[Thread:{Thread.CurrentThread.ManagedThreadId}] å¼€å§‹ä¿å­˜è®¾ç½®");
```

## 9. ä»£ç æ¶æ„è§„èŒƒ

### 9.1 é€æ˜åº¦å’Œå¸¸é‡ç®¡ç†

**ä½¿ç”¨ç»Ÿä¸€çš„å¸¸é‡ç±»**:
```csharp
// âœ… æ­£ç¡®åšæ³•
using DesktopMemo.Core.Constants;
using DesktopMemo.Core.Helpers;

var opacity = WindowConstants.DEFAULT_TRANSPARENCY;
var percent = TransparencyHelper.ToPercent(opacity);
```

**âŒ é¿å…ç¡¬ç¼–ç **:
```csharp
// é”™è¯¯ - ç¡¬ç¼–ç æ•°å€¼
var opacity = 0.05;
var maxOpacity = 0.4;
```

### 9.2 å¼‚å¸¸å¤„ç†åˆ†çº§

æ ¹æ®å¼‚å¸¸ç±»å‹æä¾›ä¸åŒçº§åˆ«çš„å¤„ç†ï¼š

```csharp
try
{
    // æ“ä½œä»£ç 
}
catch (InvalidOperationException ex)
{
    // çº§åˆ«1: æ“ä½œçŠ¶æ€å¼‚å¸¸ - ç”¨æˆ·å‹å¥½æç¤º
    SetStatus($"æ“ä½œæ— æ•ˆ: {ex.Message}");
}
catch (UnauthorizedAccessException ex)
{
    // çº§åˆ«2: æƒé™å¼‚å¸¸ - æ˜ç¡®æƒé™é—®é¢˜
    SetStatus($"æƒé™ä¸è¶³: {ex.Message}");
}
catch (IOException ex)
{
    // çº§åˆ«3: IOå¼‚å¸¸ - æ–‡ä»¶ç³»ç»Ÿé—®é¢˜
    SetStatus($"æ–‡ä»¶æ“ä½œå¤±è´¥: {ex.Message}");
}
catch (Exception ex)
{
    // çº§åˆ«4: æœªçŸ¥å¼‚å¸¸ - è®°å½•è¯¦ç»†ä¿¡æ¯
    Debug.WriteLine($"æœªçŸ¥å¼‚å¸¸: {ex}");
    SetStatus("æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");
}
```

### 9.3 è®¾ç½®ä¿å­˜åŸå­æ€§

ç¡®ä¿è®¾ç½®ä¿å­˜çš„äº‹åŠ¡æ€§ï¼Œé¿å…æ•°æ®ä¸ä¸€è‡´ï¼š

```csharp
// âœ… åŸå­æ€§ä¿å­˜
try
{
    var newSettings = currentSettings with { Property = newValue };
    await _settingsService.SaveAsync(newSettings); // å…ˆä¿å­˜åˆ°æ–‡ä»¶
    CurrentSettings = newSettings; // ä¿å­˜æˆåŠŸåæ‰æ›´æ–°å†…å­˜
}
catch (Exception ex)
{
    // ä¿å­˜å¤±è´¥ï¼Œå†…å­˜çŠ¶æ€ä¿æŒä¸å˜
    Debug.WriteLine($"è®¾ç½®ä¿å­˜å¤±è´¥: {ex}");
}
```

### 9.4 Win32 API è°ƒç”¨è§„èŒƒ

æ‰€æœ‰Win32 APIè°ƒç”¨éƒ½åº”è¯¥åŒ…å«é”™è¯¯æ£€æŸ¥ï¼š

```csharp
// âœ… å®‰å…¨çš„Win32 APIè°ƒç”¨
private static void SafeSetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int x, int y, int cx, int cy, uint uFlags, string operation)
{
    try
    {
        var success = SetWindowPos(hWnd, hWndInsertAfter, x, y, cx, cy, uFlags);
        if (!success)
        {
            var error = Marshal.GetLastWin32Error();
            Debug.WriteLine($"SetWindowPoså¤±è´¥ - æ“ä½œ: {operation}, é”™è¯¯ä»£ç : {error}");
        }
    }
    catch (Exception ex)
    {
        Debug.WriteLine($"SetWindowPoså¼‚å¸¸ - æ“ä½œ: {operation}, å¼‚å¸¸: {ex.Message}");
    }
}
```

## 10. è´¨é‡ä¿éšœ

- å½“å‰ä»“åº“å°šæœªå¼•å…¥è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œè®¡åˆ’å¯å‚è€ƒ `docs/architecture/migration-plan.md`ã€‚
- å»ºè®® PR å‰è‡³å°‘æ‰§è¡Œ `dotnet build` éªŒè¯é€šè¿‡ã€‚
- è‹¥æ–°å¢ä¾èµ–æˆ–è°ƒæ•´è¾“å‡ºç›®å½•ï¼Œè¯·åœ¨ PR æè¿°ä¸­è¯´æ˜ã€‚

## 11. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

| é—®é¢˜ç±»å‹ | å…·ä½“ç°è±¡ | è§£å†³æ–¹æ¡ˆ |
| --- | --- | --- |
| **ç¼–è¯‘é—®é¢˜** | `NETSDK1005`ï¼šæ‰¾ä¸åˆ° `project.assets.json` | å…ˆè¿è¡Œ `dotnet restore`ï¼Œç¡®è®¤æ–°è¾“å‡ºç›®å½•å·²ç”Ÿæˆï¼›å¿…è¦æ—¶åˆ é™¤ `artifacts/` é‡æ–°æ„å»ºã€‚ |
| **ç¼–è¯‘é—®é¢˜** | Assembly ç‰¹æ€§é‡å¤ | åˆ é™¤æ—§çš„ `bin/obj` ä¸ `artifacts/` åé‡æ–° `restore + build`ã€‚ |
| **UIé—®é¢˜** | æ•°æ®ç»‘å®šæœªåˆ·æ–° | æ£€æŸ¥æ˜¯å¦è°ƒç”¨ `OnPropertyChanged`ï¼Œç¡®è®¤ `MainViewModel` çš„å‘½ä»¤æ‰§è¡Œè·¯å¾„ã€‚ |
| **é€æ˜åº¦é—®é¢˜** | é‡å¯åé€æ˜åº¦å˜ä¸º0%æˆ–100% | æ£€æŸ¥è®¾ç½®æ–‡ä»¶å®Œæ•´æ€§ï¼ŒéªŒè¯ `TransparencyHelper` çš„ä½¿ç”¨æ˜¯å¦æ­£ç¡®ã€‚ |
| **å´©æºƒé—®é¢˜** | å‹¾é€‰"ä¸å†æ˜¾ç¤º"åç¨‹åºå¡é¡¿å´©æºƒ | æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº† `async void` äº‹ä»¶å¤„ç†å™¨ï¼Œæ”¹ç”¨ `Task.Run` + fire-and-forget æ¨¡å¼ã€‚ |
| **å¯¹è¯æ¡†é—®é¢˜** | ç¡®è®¤å¯¹è¯æ¡†æ— æ³•æ˜¾ç¤º | æ£€æŸ¥ `Owner` è®¾ç½®æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿åœ¨UIçº¿ç¨‹ä¸Šåˆ›å»ºå¯¹è¯æ¡†ã€‚ |
| **è®¾ç½®é—®é¢˜** | è®¾ç½®ä¿å­˜å¤±è´¥å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ | ä½¿ç”¨åŸå­æ€§ä¿å­˜æ¨¡å¼ï¼šå…ˆä¿å­˜æ–‡ä»¶ï¼ŒæˆåŠŸåå†æ›´æ–°å†…å­˜çŠ¶æ€ã€‚ |
| **Win32é—®é¢˜** | çª—å£ç½®é¡¶æˆ–é€æ˜åº¦è®¾ç½®å¤±è´¥ | æ£€æŸ¥Win32 APIè¿”å›å€¼ï¼Œä½¿ç”¨ `Marshal.GetLastWin32Error()` è·å–é”™è¯¯ä»£ç ã€‚ |

### è°ƒè¯•æŠ€å·§

**å¯ç”¨è¯¦ç»†è°ƒè¯•æ—¥å¿—**:
åœ¨Debugæ¨¡å¼ä¸‹ï¼Œåº”ç”¨ä¼šè¾“å‡ºè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯åˆ°Visual Studioçš„è¾“å‡ºçª—å£ï¼š

```csharp
// æŸ¥çœ‹è®¾ç½®åŠ è½½è¿‡ç¨‹
Debug.WriteLine($"è®¾ç½®åŠ è½½: åŸå§‹é€æ˜åº¦={settings.Transparency}, è§„èŒƒåŒ–å={normalizedValue}");

// æŸ¥çœ‹å¼‚æ­¥æ“ä½œçŠ¶æ€
Debug.WriteLine($"[Thread:{Thread.CurrentThread.ManagedThreadId}] å¼€å§‹ä¿å­˜è®¾ç½®");

// æŸ¥çœ‹Win32 APIè°ƒç”¨ç»“æœ
Debug.WriteLine($"SetWindowPoså¤±è´¥ - æ“ä½œ: {operation}, é”™è¯¯ä»£ç : {error}");
```

**æ£€æŸ¥è®¾ç½®æ–‡ä»¶**:
è®¾ç½®æ–‡ä»¶ä½ç½®ï¼š`åº”ç”¨ç›®å½•/.memodata/settings.json`

å¦‚æœè®¾ç½®å¼‚å¸¸ï¼Œå¯ä»¥ï¼š
1. åˆ é™¤ `settings.json` æ–‡ä»¶é‡ç½®ä¸ºé»˜è®¤è®¾ç½®
2. æ£€æŸ¥æ–‡ä»¶å†…å®¹æ˜¯å¦ä¸ºæœ‰æ•ˆçš„JSONæ ¼å¼
3. æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶ `settings.json.backup`ï¼ˆå¦‚æœå­˜åœ¨ï¼‰

**æ€§èƒ½åˆ†æ**:
- ä½¿ç”¨Visual Studioçš„è¯Šæ–­å·¥å…·ç›‘æ§å†…å­˜å’ŒCPUä½¿ç”¨
- æ³¨æ„å¼‚æ­¥æ“ä½œæ˜¯å¦é˜»å¡UIçº¿ç¨‹
- æ£€æŸ¥æ˜¯å¦å­˜åœ¨å†…å­˜æ³„æ¼ï¼ˆç‰¹åˆ«æ˜¯äº‹ä»¶è®¢é˜…ï¼‰

å¦‚æœ‰æ›´å¤šé—®é¢˜ï¼Œå¯åœ¨ä»“åº“ [issues](../../issues) åŒºåé¦ˆã€‚
